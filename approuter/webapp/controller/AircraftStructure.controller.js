sap.ui.define(["sap/ui/core/mvc/Controller","ui5/rest/restwithui5/utils/utilFunctions"],function(e,t){"use strict";return e.extend("ui5.rest.restwithui5.controller.AircraftStructure",{onInit:function(){console.log("AircraftStructure controller called");this.oBus=sap.ui.getCore().getEventBus();this.oBus.subscribe("Flight","DataLoaded",this.handleFlightDataLoaded,this);this.oBus.publish("AircraftStructure","RenderPassengerForm",{ok:"OK"});this.DataRepository=this.getOwnerComponent().DataRepository;const e=this.getOwnerComponent().getModel();console.log(e);this.selectedSeats=null},handleFlightDataLoaded:function(e,s,o){console.log("Flight data loaded for flight ID:",o.flight);const l=this.getOwnerComponent().getModel();const i=o.flight.seats;const c=o.flight.availableSeats;console.log("availableSeats in AircraftStructureController is ",c);let n=[];for(let e=0;e<i;e++){let t=true;if(c.includes(e+1)){t=false}n.push({seat:e+1,disabled:t,icon:t?"sap-icon://color-fill":"sap-icon://border"})}l.setProperty("/flight/duration",t.getDuration(o.flight.departureDateTimeLocal,o.flight.arrivalDateTimeLocal));l.setProperty("/flight/allSeats",n);l.setProperty("/flight/selectedSeats",[]);console.log(l.getProperty("/flight/selectedSeats"));l.setProperty("/flight/passengers",[])},selectSeat:function(e){console.log("selectSeat function called");const t=e.getSource();const s=t.getBindingContext();console.log("Aircraft seat Button binding Context",s);const o=s.getModel();const l=this.getOwnerComponent().getModel();const i=o.getProperty(s.getPath());const c=i.seat;const n=this.getView().getModel();if(t.getIcon()==="sap-icon://border"){t.setIcon("sap-icon://color-fill");if(!this.selectedSeats||!this.selectedSeats.length){this.selectedSeats=[c];console.log(this.selectedSeats)}else{this.selectedSeats.push(c);console.log(this.selectedSeats)}this.oBus.publish("Flight","SeatSelected",{selectedSeats:this.selectedSeats,create:true,seatPressed:c})}else{t.setIcon("sap-icon://border");this.selectedSeats=this.selectedSeats.filter(e=>e!=c);console.log(this.selectedSeats);this.oBus.publish("Flight","SeatSelected",{selectedSeats:this.selectedSeats,create:false,seatPressed:c})}l.setProperty("/flight/selectedSeats",this.selectedSeats.slice());console.log(n)},onExit:function(){console.log("AircraftStructure exit called");const e=this.getOwnerComponent().getModel();e.setProperty("/flight/selectedSeats",null)}})});
//# sourceMappingURL=AircraftStructure.controller.js.map