sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast"],function(e,t){"use strict";return e.extend("ui5.rest.restwithui5.controller.PassengerForm",{onInit:function(){console.log("PassengerForm controller fired");const e=this.getOwnerComponent().getModel();const t=e.getProperty("/flight/selectedSeats");const s={passengerName:"",passengerAge:0,passengerIdProof:""};const n=this.getView();this.oBus=sap.ui.getCore().getEventBus();this.oBus.subscribe("Flight","SeatSelected",this.handleSeatSelectedEvent,this);console.log("Binding Context",n);this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getRoute("detail").attachPatternMatched(this._handleRoutePatternMatched,this)},_handleRoutePatternMatched:function(){this.getView().getModel().setProperty("/passengersCount",0)},handleSeatSelectedEvent:function(e,t,s){console.log("handleSeatSelectedEvent called");const n=this.getOwnerComponent().getModel();console.log("oModel in passengerForm",n);console.log("oData in passengerForm",s);const o=this.getView().getBindingContext();console.log("Passenger BindingConetxt is",o);const r=n.getProperty("/flight/passengers").length;let i=n.getProperty("/flight/passengers");const l={index:r+1,passengerName:"",passengerAge:null,passengerIdProof:"",seat:s.seatPressed};if(s.create){i.push(l);console.log("Passenger after adding of seat",this.passengers);n.setProperty("/flight/passengers",i.slice())}else{console.log("Calling...");console.log(i);console.log(s);i=i.filter(e=>e.seat!=s.seatPressed);console.log("Passenger after removal of seat",i);console.log(this.getView());n.setProperty("/flight/passengers",i.slice())}this.getView().getModel().setProperty("/passengersCount",i.length);console.log("View",this.getView())},onSaveAllPassengersButtonPress:function(){const e=this.getView();if(this._verifyPassengers()){t(e)}function t(e){if(e instanceof sap.m.Input){e.setEnabled(false)}else if(e.getContent){var s=e.getContent();if(s){s.forEach(t)}}else if(e.getItems){var n=e.getItems();if(n){n.forEach(t)}}}},isSelectedSeats:function(e){return e!=null&&e.length>0},_verifyPassengers:function(){const e=this.getView();const s=e.getBindingContext().getProperty("/flight/passengers");let n=true;s.forEach(e=>{if(Object.values(e).includes("")){t.show("All the Passenger details are required");n=false}else if(typeof Number(e.passengerAge)!=="number"){t.show("All the Passenger's Age must be a number");n=false}});return n},onEditFormButtonPress:function(){console.log("onEditFormButtonPress called");const e=this.getView();const t=function(e){if(e instanceof sap.m.Input){e.setEnabled(true)}else if(e.getContent){var s=e.getContent();if(s){s.forEach(t)}}else if(e.getItems){var n=e.getItems();if(n){n.forEach(t)}}};t(e)},getAmount:function(e){if(!e)return 0;return e*this.selectedSeats.length},onExit:function(){console.log("Passenger Form exit called");const e=this.getOwnerComponent().getModel();e.setProperty("/flight/selectedSeats",null)}})});
//# sourceMappingURL=PassengerForm.controller.js.map