sap.ui.define(["sap/m/MessageToast","sap/ui/core/BusyIndicator"],function(e,o){"use strict";return{createTravelerWithUserRole:function(s){o.show();console.log(s);jQuery.post({url:this._baseURL+"/traveler",contentType:"application/json",data:JSON.stringify({...s}),success:function(e){console.log("oTraveler in travelerService",e);var s=sap.ui.getCore().getEventBus();s.publish("Traveler","AddTravelerSuccess",{oTraveler:e});o.hide()}.bind(this),error:function(s){console.log(s);e.show(s.responseJSON.message);o.hide()}})},login:function(s,n,i=false){o.show();console.log("Login function called in traveler service with ",s,n,i);jQuery.post({url:this._baseURL+"/authenticate",contentType:"application/json",data:JSON.stringify({username:s,password:n,isAdmin:i?i:false}),success:function(s){console.log("oTraveler in travelerService",s);e.show("User login Successfully");window.localStorage.setItem("FBS_token",s.jwt);var n=sap.ui.getCore().getEventBus();n.publish("Traveler","LoginSuccess",{oJwt:s});o.hide()}.bind(this),error:function(s){console.log(s);e.show("Incorrect username or password");o.hide()}})},getTravelerBookings:function(){o.show();console.log("getTravelerBookings function called in traveler service with ");const s=window.localStorage.getItem("FBS_token");jQuery.get({url:this._baseURL+"/traveler/bookings",contentType:"application/json",headers:{Authorization:"Bearer "+s},success:function(e){console.log("oBookings in travelerService",e);var s=sap.ui.getCore().getEventBus();s.publish("Traveler","GetBookingsSuccess",{oBookings:e});o.hide()}.bind(this),error:function(s){console.log(s);e.show("Please login before...",{closeOnBrowserNavigation:false});o.hide();this.onNavBack()}.bind(this)})},cancelBooking:function(s){o.show();const n=window.localStorage.getItem("FBS_token");if(!n){e.show("Login please...",{closeOnBrowserNavigation:false});this.getRouter().navTo("login");return}jQuery.ajax({url:this._baseURL+"/booking/cancel",type:"PATCH",contentType:"application/json",headers:{Authorization:"Bearer "+n},data:JSON.stringify({bookingId:s}),success:function(s){console.log("response in cancelSeats",s);e.show("Booking cancelled successfully");var n=sap.ui.getCore().getEventBus();n.publish("FlightService","cancelSeatsSuccess",{booking:s});o.hide()},error:function(s){e.show(s.responseJSON.message);console.log(s);o.hide()}})},onNavBack:function(){const e=this.onNavBack();e()}}});
//# sourceMappingURL=TravelerService.js.map