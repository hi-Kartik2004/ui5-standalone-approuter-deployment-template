sap.ui.define(["sap/ui/base/ManagedObject","sap/m/MessageToast","sap/ui/commons/Message"],function(e,o,t){"use strict";const n=["Booking"];const s=["addAirport","addFlight"];return{getPrivateRouteNames:function(){return n},getAdminRouteNames:function(){return s},validateAdmin:function(e){console.log("checking isAdmin");console.log(e);const t=e.getModel();console.log(t);const n=t.getProperty("/user/userType");console.log(n);this.validateUser(e,{redirectTo:"loginAdmin"});if(!n||n.toUpperCase()!=="ADMIN"){o.show("You are not authorized to view that page",{closeOnBrowserNavigation:false});e.getRouter().navTo("RouteInitial")}},validateUser:function(e,t={}){console.log("checking isUser");console.log(e);var n=e.getModel();if(window.localStorage.getItem("FBS_token")){console.log("FBS_token found");const s=n.getProperty("/user");console.log(s.exp*1e3>Date.now());if(s.exp*1e3<Date.now()){console.log("redirecting...token expired..");o.show("Session expired login again!");t.redirectTo?e.getRouter().navTo(t.redirectTo):e.getRouter().navTo("login")}else{console.log("success");const e=sap.ui.getCore().getEventBus();e.publish("auth","user",{user:n.getProperty("/user")})}}else{o.show("Please login to continue...");e.getRouter().navTo("login")}}}});
//# sourceMappingURL=securityConfig.js.map